/// <reference types="bn.js" />
import { BN } from '@coral-xyz/anchor';
import { MarketType } from './types';
export type MarginCategory = 'Initial' | 'Maintenance' | 'Fill';
export type MarginCalculationMode = {
    type: 'Standard';
} | {
    type: 'Liquidation';
};
export declare class MarketIdentifier {
    marketType: MarketType;
    marketIndex: number;
    private constructor();
    static spot(marketIndex: number): MarketIdentifier;
    static perp(marketIndex: number): MarketIdentifier;
    equals(other: MarketIdentifier | undefined): boolean;
}
export declare class MarginContext {
    marginType: MarginCategory;
    mode: MarginCalculationMode;
    strict: boolean;
    ignoreInvalidDepositOracles: boolean;
    marginBuffer: BN;
    marginRatioOverride?: number;
    private constructor();
    static standard(marginType: MarginCategory): MarginContext;
    static liquidation(marginBuffer: BN): MarginContext;
    strictMode(strict: boolean): this;
    ignoreInvalidDeposits(ignore: boolean): this;
    setMarginBuffer(buffer?: BN): this;
    setMarginRatioOverride(ratio: number): this;
}
export declare class IsolatedMarginCalculation {
    marginRequirement: BN;
    totalCollateral: BN;
    totalCollateralBuffer: BN;
    marginRequirementPlusBuffer: BN;
    constructor();
    getTotalCollateralPlusBuffer(): BN;
    meetsMarginRequirement(): boolean;
    meetsMarginRequirementWithBuffer(): boolean;
    marginShortage(): BN;
}
export declare class MarginCalculation {
    context: MarginContext;
    totalCollateral: BN;
    totalCollateralBuffer: BN;
    marginRequirement: BN;
    marginRequirementPlusBuffer: BN;
    isolatedMarginCalculations: Map<number, IsolatedMarginCalculation>;
    numSpotLiabilities: number;
    numPerpLiabilities: number;
    allDepositOraclesValid: boolean;
    allLiabilityOraclesValid: boolean;
    withPerpIsolatedLiability: boolean;
    withSpotIsolatedLiability: boolean;
    totalSpotLiabilityValue: BN;
    totalPerpLiabilityValue: BN;
    trackedMarketMarginRequirement: BN;
    fuelDeposits: number;
    fuelBorrows: number;
    fuelPositions: number;
    constructor(context: MarginContext);
    addCrossMarginTotalCollateral(delta: BN): void;
    addCrossMarginRequirement(marginRequirement: BN, liabilityValue: BN): void;
    addIsolatedMarginCalculation(marketIndex: number, depositValue: BN, pnl: BN, liabilityValue: BN, marginRequirement: BN): void;
    addSpotLiability(): void;
    addPerpLiability(): void;
    addSpotLiabilityValue(spotLiabilityValue: BN): void;
    addPerpLiabilityValue(perpLiabilityValue: BN): void;
    updateAllDepositOraclesValid(valid: boolean): void;
    updateAllLiabilityOraclesValid(valid: boolean): void;
    updateWithSpotIsolatedLiability(isolated: boolean): void;
    updateWithPerpIsolatedLiability(isolated: boolean): void;
    validateNumSpotLiabilities(): void;
    getNumOfLiabilities(): number;
    getCrossTotalCollateralPlusBuffer(): BN;
    meetsCrossMarginRequirement(): boolean;
    meetsCrossMarginRequirementWithBuffer(): boolean;
    meetsMarginRequirement(): boolean;
    meetsMarginRequirementWithBuffer(): boolean;
    getCrossFreeCollateral(): BN;
    getIsolatedFreeCollateral(marketIndex: number): BN;
    getIsolatedMarginCalculation(marketIndex: number): IsolatedMarginCalculation | undefined;
    hasIsolatedMarginCalculation(marketIndex: number): boolean;
}
